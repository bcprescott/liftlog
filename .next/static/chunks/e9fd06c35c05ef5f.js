(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,49130,e=>{e.v({avatar:"leaderboard-module__hOVDzq__avatar",date:"leaderboard-module__hOVDzq__date",filterSelect:"leaderboard-module__hOVDzq__filterSelect",pageHeader:"leaderboard-module__hOVDzq__pageHeader",rank:"leaderboard-module__hOVDzq__rank",table:"leaderboard-module__hOVDzq__table",tableContainer:"leaderboard-module__hOVDzq__tableContainer",userCell:"leaderboard-module__hOVDzq__userCell",weight:"leaderboard-module__hOVDzq__weight"})},85614,e=>{"use strict";var t=e.i(10551),l=e.i(92361),r=e.i(2606),a=e.i(49130),s=e.i(79818);let i=(0,s.default)("heart",[["path",{d:"M2 9.5a5.5 5.5 0 0 1 9.591-3.676.56.56 0 0 0 .818 0A5.49 5.49 0 0 1 22 9.5c0 2.29-1.5 4-3 5.5l-5.492 5.313a2 2 0 0 1-3 .019L5 15c-1.5-1.5-3-3.2-3-5.5",key:"mvr1a0"}]]),d=(0,s.default)("message-circle",[["path",{d:"M2.992 16.342a2 2 0 0 1 .094 1.167l-1.065 3.29a1 1 0 0 0 1.236 1.168l3.413-.998a2 2 0 0 1 1.099.092 10 10 0 1 0-4.777-4.719",key:"1sd12s"}]]),n=(0,s.default)("send",[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]]),o=(0,s.default)("trash-2",[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]]);var c=e.i(41248);let h=({logId:e,userId:a})=>{let[s,i]=(0,l.useState)([]),[d,h]=(0,l.useState)(!0),[u,m]=(0,l.useState)(""),[x,p]=(0,l.useState)(!1),f=(0,r.createClient)(),g=async()=>{h(!0);let{data:t}=await f.from("comments").select(`
                *,
                profiles (
                    username,
                    full_name,
                    avatar_url
                )
            `).eq("log_id",e).order("created_at",{ascending:!0});t&&i(t),h(!1)};(0,l.useEffect)(()=>{g()},[e]);let y=async t=>{if(t.preventDefault(),!a||!u.trim())return;p(!0);let{error:l}=await f.from("comments").insert({log_id:e,user_id:a,content:u.trim()});l?c.toast.error("Failed to post comment"):(m(""),g()),p(!1)},j=async e=>{if(!confirm("Are you sure you want to delete this comment?"))return;let{error:t}=await f.from("comments").delete().eq("id",e);t?c.toast.error("Failed to delete comment"):(i(s.filter(t=>t.id!==e)),c.toast.success("Comment deleted"))};return(0,t.jsxs)("div",{style:{padding:"15px",background:"var(--bg-secondary)",borderTop:"1px solid var(--border-color)"},children:[d?(0,t.jsx)("div",{style:{fontSize:"0.9rem",color:"var(--text-secondary)"},children:"Loading comments..."}):0===s.length?(0,t.jsx)("div",{style:{fontSize:"0.9rem",color:"var(--text-secondary)",marginBottom:"10px"},children:"No comments yet. Be the first!"}):(0,t.jsx)("div",{style:{display:"flex",flexDirection:"column",gap:"10px",marginBottom:"15px"},children:s.map(e=>(0,t.jsxs)("div",{style:{display:"flex",gap:"10px"},children:[(0,t.jsx)("div",{style:{width:"30px",height:"30px",borderRadius:"50%",overflow:"hidden",background:"#333",flexShrink:0},children:e.profiles?.avatar_url&&(0,t.jsx)("img",{src:e.profiles.avatar_url,style:{width:"100%",height:"100%",objectFit:"cover"}})}),(0,t.jsxs)("div",{style:{flex:1},children:[(0,t.jsxs)("div",{style:{fontSize:"0.85rem",fontWeight:"600",display:"flex",alignItems:"center",justifyContent:"space-between"},children:[(0,t.jsxs)("span",{children:[e.profiles?.full_name||e.profiles?.username||"User",(0,t.jsx)("span",{style:{fontSize:"0.75rem",color:"var(--text-secondary)",fontWeight:"normal",marginLeft:"8px"},children:new Date(e.created_at).toLocaleDateString()})]}),a===e.user_id&&(0,t.jsx)("button",{onClick:()=>j(e.id),style:{background:"none",border:"none",cursor:"pointer",color:"var(--text-muted)",padding:"4px"},title:"Delete comment",children:(0,t.jsx)(o,{size:14})})]}),(0,t.jsx)("div",{style:{fontSize:"0.9rem",color:"var(--text-primary)"},children:e.content})]})]},e.id))}),a?(0,t.jsxs)("form",{onSubmit:y,style:{display:"flex",gap:"10px"},children:[(0,t.jsx)("input",{type:"text",value:u,onChange:e=>m(e.target.value),placeholder:"Write a comment...",style:{flex:1,padding:"8px",borderRadius:"4px",border:"1px solid var(--border-color)",background:"var(--bg-card)",color:"var(--text-primary)"}}),(0,t.jsx)("button",{type:"submit",disabled:x,className:"btn btn-sm",style:{display:"flex",alignItems:"center"},children:(0,t.jsx)(n,{size:16})})]}):(0,t.jsx)("div",{style:{fontSize:"0.9rem",color:"var(--text-secondary)"},children:"Log in to comment"})]})};function u(){let[e,s]=(0,l.useState)([]),[n,o]=(0,l.useState)("latest"),[u,m]=(0,l.useState)([]),[x,p]=(0,l.useState)(!1),[f,g]=(0,l.useState)(null),[y,j]=(0,l.useState)(null),_=(0,r.createClient)();(0,l.useEffect)(()=>{let e=async()=>{let{data:{user:e}}=await _.auth.getUser();g(e?.id||null)};(async()=>{let{data:e}=await _.from("lift_types").select("*").order("name");e&&e.length>0&&s(e)})(),e()},[]);let v=async()=>{p(!0);let e=_.from("logs").select(`
          *,
          profiles (
            username,
            full_name,
            avatar_url
          ),
          lift_types (
            name
          ),
          likes!left (
            user_id
          ),
          comments!left (
            count
          )
        `);e="latest"===n?e.order("date_logged",{ascending:!1}):e.eq("lift_type_id",parseInt(n)).order("weight",{ascending:!1});let{data:t,error:l}=await e.limit(50);t&&m(t),p(!1)};(0,l.useEffect)(()=>{v()},[n]);let b=async(e,t)=>{if(!f)return void c.toast.error("Please log in to like lifts");let l=t.some(e=>e.user_id===f);m(u.map(t=>t.id===e?{...t,likes:l?t.likes.filter(e=>e.user_id!==f):[...t.likes,{user_id:f}]}:t)),l?await _.from("likes").delete().match({user_id:f,log_id:e}):await _.from("likes").insert({user_id:f,log_id:e})};return(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:a.default.pageHeader,children:[(0,t.jsx)("h1",{children:"Leaderboard"}),(0,t.jsxs)("select",{className:a.default.filterSelect,value:n,onChange:e=>o(e.target.value),children:[(0,t.jsx)("option",{value:"latest",children:"Latest Lifts"}),e.map(e=>(0,t.jsx)("option",{value:e.id,children:e.name},e.id))]})]}),(0,t.jsx)("div",{className:a.default.tableContainer,children:(0,t.jsxs)("table",{className:a.default.table,style:{borderCollapse:"collapse"},children:[(0,t.jsx)("thead",{children:(0,t.jsxs)("tr",{children:[(0,t.jsx)("th",{children:"Rank"}),(0,t.jsx)("th",{children:"Lifter"}),(0,t.jsx)("th",{children:"Lift"}),(0,t.jsx)("th",{children:"Weight"}),(0,t.jsx)("th",{children:"Date"}),(0,t.jsx)("th",{children:"Notes"}),(0,t.jsx)("th",{children:"Actions"})]})}),(0,t.jsx)("tbody",{children:x?(0,t.jsx)("tr",{children:(0,t.jsx)("td",{colSpan:7,style:{textAlign:"center"},children:"Loading..."})}):0===u.length?(0,t.jsx)("tr",{children:(0,t.jsx)("td",{colSpan:7,style:{textAlign:"center"},children:"No lifts..."})}):u.map((e,l)=>{let r=e.likes?.some(e=>e.user_id===f),s=y===e.id,n=e.comments?.[0]?.count||0;return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("tr",{style:{borderBottom:s?"none":"1px solid var(--border-color)"},children:[(0,t.jsxs)("td",{className:a.default.rank,children:["#",l+1]}),(0,t.jsx)("td",{children:(0,t.jsxs)("div",{className:a.default.userCell,children:[e.profiles?.avatar_url&&(0,t.jsx)("img",{src:e.profiles.avatar_url,alt:"avatar",className:a.default.avatar}),(0,t.jsx)("span",{children:e.profiles?.full_name||e.profiles?.username||"Anonymous"})]})}),(0,t.jsx)("td",{children:e.lift_types?.name||e.lift_name||"-"}),(0,t.jsxs)("td",{className:a.default.weight,children:[e.weight," ",e.unit]}),(0,t.jsx)("td",{className:a.default.date,children:new Date(e.date_logged).toLocaleDateString()}),(0,t.jsx)("td",{style:{maxWidth:"200px",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",color:"var(--text-secondary)"},children:e.notes||"-"}),(0,t.jsx)("td",{children:(0,t.jsxs)("div",{style:{display:"flex",gap:"15px"},children:[(0,t.jsxs)("button",{onClick:()=>b(e.id,e.likes||[]),style:{background:"none",border:"none",cursor:"pointer",display:"flex",alignItems:"center",gap:"4px",color:"inherit"},children:[(0,t.jsx)(i,{size:18,fill:r?"#ef4444":"none",color:r?"#ef4444":"currentColor"}),(0,t.jsx)("span",{children:e.likes?.length||0})]}),(0,t.jsxs)("button",{onClick:()=>j(s?null:e.id),style:{background:"none",border:"none",cursor:"pointer",display:"flex",alignItems:"center",gap:"4px",color:s?"var(--brand-primary)":"inherit"},children:[(0,t.jsx)(d,{size:18}),(0,t.jsx)("span",{children:n})]})]})})]},e.id),s&&(0,t.jsx)("tr",{children:(0,t.jsx)("td",{colSpan:7,style:{padding:0},children:(0,t.jsx)(h,{logId:e.id,userId:f})})})]})})})]})})]})}e.s(["default",()=>u],85614)}]);