(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[702],{8127:function(e,t,r){Promise.resolve().then(r.bind(r,2469))},2469:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return j}});var a=r(3827),s=r(4090),l=r(1097),i=r(3321),o=r.n(i),n=r(6288),d=r(4832);function c(e){let{onLogSuccess:t,initialData:r,onCancel:i}=e,[c,u]=(0,s.useState)([]),[g,p]=(0,s.useState)(!1),m=(0,l.e)(),[h,f]=(0,s.useState)(""),[x,b]=(0,s.useState)(""),[v,y]=(0,s.useState)(""),[_,j]=(0,s.useState)(""),[S,N]=(0,s.useState)(""),[w,L]=(0,s.useState)("");(0,s.useEffect)(()=>{(async()=>{let{data:e}=await m.from("lift_types").select("*").order("name");e&&u(e)})()},[]),(0,s.useEffect)(()=>{if(r){var e,t;f((null===(e=r.lift_type_id)||void 0===e?void 0:e.toString())||""),b(r.weight.toString()),y((null===(t=r.body_weight)||void 0===t?void 0:t.toString())||""),j(r.reps.toString()),N(r.rpe?r.rpe.toString():""),L(r.notes||"")}else f(""),b(""),y(""),j(""),N(""),L("")},[r]);let C=async e=>{let a;e.preventDefault(),p(!0);let{data:{user:s}}=await m.auth.getUser();if(!s){alert("You must be logged in"),p(!1);return}let l={user_id:s.id,lift_type_id:parseInt(h),weight:parseFloat(x),body_weight:v?parseFloat(v):null,reps:parseInt(_),rpe:S?parseInt(S):null,notes:w||null,date_logged:new Date().toISOString()};if(r){let e={...l,date_logged:r.date_logged},{error:t}=await m.from("logs").update(e).eq("id",r.id);a=t}else{let{error:e}=await m.from("logs").insert(l);a=e}a?(console.error("Error logging lift:",a),n.toast.error("Failed to log lift")):(r?n.toast.success("Log updated!"):(b(""),j(""),N(""),L(""),(0,d.Z)({particleCount:100,spread:70,origin:{y:.6}}),n.toast.success("Lift logged successfully!")),t(),i&&i()),p(!1)};return(0,a.jsxs)("form",{className:o().formContainer,onSubmit:C,children:[(0,a.jsx)("h3",{style:{marginBottom:"1rem"},children:r?"Edit Log":"Log a Set"}),(0,a.jsxs)("div",{className:o().formGrid,children:[(0,a.jsxs)("div",{className:o().formGroup,children:[(0,a.jsx)("label",{className:o().label,children:"Lift"}),(0,a.jsxs)("select",{className:o().select,value:h,onChange:e=>f(e.target.value),required:!0,children:[(0,a.jsx)("option",{value:"",children:"Select Lift"}),c.map(e=>(0,a.jsx)("option",{value:e.id,children:e.name},e.id))]})]}),(0,a.jsxs)("div",{className:o().formGroup,children:[(0,a.jsx)("label",{className:o().label,children:"Body Weight (lbs)"}),(0,a.jsx)("input",{type:"number",step:"0.1",className:o().input,value:v,onChange:e=>y(e.target.value),placeholder:"Optional"})]}),(0,a.jsxs)("div",{className:o().formGroup,children:[(0,a.jsx)("label",{className:o().label,children:"Lift Weight (lbs)"}),(0,a.jsx)("input",{type:"number",step:"0.5",className:o().input,value:x,onChange:e=>b(e.target.value),required:!0,placeholder:"0"})]}),(0,a.jsxs)("div",{className:o().formGroup,children:[(0,a.jsx)("label",{className:o().label,children:"Reps"}),(0,a.jsx)("input",{type:"number",className:o().input,value:_,onChange:e=>j(e.target.value),required:!0,placeholder:"0"})]}),(0,a.jsxs)("div",{className:o().formGroup,children:[(0,a.jsx)("label",{className:o().label,children:"RPE (1-10)"}),(0,a.jsx)("input",{type:"number",min:"1",max:"10",className:o().input,value:S,onChange:e=>N(e.target.value),placeholder:"Optional"})]})]}),(0,a.jsxs)("div",{className:o().formGroup,children:[(0,a.jsx)("label",{className:o().label,children:"Notes"}),(0,a.jsx)("textarea",{className:"".concat(o().input," ").concat(o().textArea),value:w,onChange:e=>L(e.target.value),placeholder:"How did it feel?"})]}),(0,a.jsxs)("div",{style:{display:"flex",gap:"10px"},children:[(0,a.jsx)("button",{type:"submit",className:"btn btn-primary ".concat(o().submitBtn),disabled:g,style:{flex:1},children:g?"Saving...":r?"Update Log":"Log Lift"}),r&&(0,a.jsx)("button",{type:"button",onClick:i,className:"btn",style:{backgroundColor:"var(--surface)",color:"var(--text-primary)",border:"1px solid var(--border)"},children:"Cancel"})]})]})}var u=r(7819),g=r(6371),p=r(8333),m=r(3356),h=r(2983),f=r(5758),x=r(2142);function b(e){let{logs:t}=e,r=(0,s.useMemo)(()=>Object.values(t.reduce((e,t)=>{let r=new Date(t.date_logged).toLocaleDateString();return(!e[r]||t.weight>e[r].weight)&&(e[r]={date:r,weight:t.weight,reps:t.reps,fullDate:new Date(t.date_logged)}),e},{})).sort((e,t)=>e.fullDate.getTime()-t.fullDate.getTime()),[t]);return 0===r.length?(0,a.jsx)("div",{style:{padding:"20px",textAlign:"center",color:"var(--text-secondary)",background:"var(--card-bg)",borderRadius:"var(--radius)",border:"1px solid var(--border)"},children:"No data available for this lift."}):(0,a.jsxs)("div",{style:{height:"300px",width:"100%",marginTop:"20px",marginBottom:"20px",background:"var(--card-bg)",padding:"20px",borderRadius:"var(--radius)",border:"1px solid var(--border)"},children:[(0,a.jsx)("h3",{style:{marginBottom:"20px"},children:"Progress History"}),(0,a.jsx)(u.h,{width:"100%",height:"100%",children:(0,a.jsxs)(g.w,{data:r,children:[(0,a.jsx)(p.q,{strokeDasharray:"3 3",opacity:.1}),(0,a.jsx)(m.K,{dataKey:"date",stroke:"var(--text-secondary)",fontSize:12,tickLine:!1}),(0,a.jsx)(h.B,{stroke:"var(--text-secondary)",fontSize:12,tickLine:!1,domain:["auto","auto"]}),(0,a.jsx)(f.u,{contentStyle:{backgroundColor:"var(--bg-card)",borderColor:"var(--border)",color:"var(--text-primary)"},itemStyle:{color:"var(--primary)"}}),(0,a.jsx)(x.x1,{type:"monotone",dataKey:"weight",stroke:"var(--primary)",strokeWidth:2,activeDot:{r:6},dot:!1})]})})]})}var v=r(7907),y=r(623),_=r.n(y);function j(){let[e,t]=(0,s.useState)([]),[r,i]=(0,s.useState)([]),[o,d]=(0,s.useState)(""),[u,g]=(0,s.useState)(!0),[p,m]=(0,s.useState)(null),h=(0,l.e)(),f=(0,v.useRouter)(),x=async()=>{let{data:{user:e}}=await h.auth.getUser();if(!e){f.push("/login");return}let{data:r,error:a}=await h.from("logs").select("\n        *,\n        lift_types (\n          *\n        )\n      ").eq("user_id",e.id).order("date_logged",{ascending:!1}).limit(50);r&&t(r),g(!1),m(null)},[y,j]=(0,s.useState)([]),S=async e=>{if(!e)return;let{data:{user:t}}=await h.auth.getUser();if(!t)return;let{data:r}=await h.from("logs").select("*").eq("user_id",t.id).eq("lift_type_id",e).order("date_logged",{ascending:!1});r&&j(r)};(0,s.useEffect)(()=>{o&&S(o)},[o]);let N=async()=>{let{data:e}=await h.from("lift_types").select("*").order("name");e&&e.length>0&&(i(e),d(e[0].id.toString()))};(0,s.useEffect)(()=>{x(),N()},[]);let w=async r=>{if(!confirm("Are you sure you want to delete this log?"))return;let{error:a}=await h.from("logs").delete().eq("id",r);a?(console.error("Error deleting log:",a),n.toast.error("Failed to delete log")):(t(e.filter(e=>e.id!==r)),n.toast.success("Log deleted"))};return(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:_().header,children:[(0,a.jsx)("h1",{children:"Dashboard"}),(0,a.jsx)("p",{style:{color:"var(--text-secondary)"},children:"Track your progress"})]}),(0,a.jsx)(c,{onLogSuccess:x,initialData:p,onCancel:()=>m(null)}),e.length>0&&(0,a.jsxs)("div",{style:{marginTop:"2rem"},children:[(0,a.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"1rem"},children:[(0,a.jsx)("h2",{className:_().sectionTitle,style:{margin:0},children:"Progress"}),(0,a.jsx)("select",{value:o,onChange:e=>d(e.target.value),style:{padding:"5px",borderRadius:"4px",border:"1px solid var(--border)",background:"var(--bg-card)",color:"var(--text-primary)"},children:r.map(e=>(0,a.jsx)("option",{value:e.id,children:e.name},e.id))})]}),(0,a.jsx)(b,{logs:y})]}),(0,a.jsx)("h2",{className:_().sectionTitle,children:"Recent Activity"}),u?(0,a.jsx)("p",{children:"Loading history..."}):0===e.length?(0,a.jsx)("p",{style:{color:"var(--text-muted)"},children:"No lifts logged yet. Get to work!"}):(0,a.jsx)("div",{className:_().logsList,children:e.map(e=>{var t;return(0,a.jsxs)("div",{className:_().logCard,children:[(0,a.jsxs)("div",{className:_().logMain,children:[(0,a.jsx)("span",{className:_().liftName,children:(null===(t=e.lift_types)||void 0===t?void 0:t.name)||e.lift_name}),(0,a.jsxs)("span",{className:_().liftStats,children:[e.weight," lbs \xd7 ",e.reps," reps",e.rpe&&(0,a.jsxs)("span",{style:{fontSize:"0.8em",opacity:.7,marginLeft:"8px"},children:["@ RPE ",e.rpe]}),(0,a.jsxs)("span",{style:{fontSize:"0.8em",color:"var(--brand-primary)",marginLeft:"8px",fontWeight:"600"},children:["(1RM: ",Math.round(e.weight*(1+e.reps/30)),")"]}),e.body_weight&&(0,a.jsxs)("span",{style:{fontSize:"0.8em",color:"var(--text-muted)",marginLeft:"8px"},children:["[BW: ",e.body_weight,"]"]})]}),e.notes&&(0,a.jsx)("div",{style:{fontSize:"0.9rem",color:"var(--text-secondary)",marginTop:"4px",fontStyle:"italic"},children:e.notes})]}),(0,a.jsxs)("div",{style:{display:"flex",flexDirection:"column",alignItems:"flex-end",gap:"5px"},children:[(0,a.jsx)("div",{className:_().liftDate,children:new Date(e.date_logged).toLocaleDateString()}),(0,a.jsxs)("div",{style:{display:"flex",gap:"5px"},children:[(0,a.jsx)("button",{className:"btn btn-sm",style:{fontSize:"0.8rem",padding:"2px 8px",backgroundColor:"transparent",border:"1px solid var(--border)"},onClick:()=>{m(e),window.scrollTo({top:0,behavior:"smooth"})},children:"Edit"}),(0,a.jsx)("button",{className:"btn btn-sm",style:{fontSize:"0.8rem",padding:"2px 8px",backgroundColor:"transparent",border:"1px solid var(--border)",color:"var(--error, #ef4444)"},onClick:()=>w(e.id),children:"Delete"})]})]})]},e.id)})})]})}},1097:function(e,t,r){"use strict";r.d(t,{e:function(){return s}});var a=r(101);function s(){return(0,a.AY)("https://svqlrwwchfhyinqinbuo.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InN2cWxyd3djaGZoeWlucWluYnVvIiwicm9sZSI6InNlcnZpY2Vfcm9sZSIsImlhdCI6MTc2OTkxMDA2OCwiZXhwIjoyMDg1NDg2MDY4fQ.VpbGvrgtuzIuE6s_QYwsTrHWSijtSzrO7vTJcSOayx0")}},623:function(e){e.exports={header:"dashboard_header__0IQ3E",sectionTitle:"dashboard_sectionTitle__QgSIN",logsList:"dashboard_logsList__0dnMI",logCard:"dashboard_logCard__Q0d6z",logMain:"dashboard_logMain__rb2wH",liftName:"dashboard_liftName__FKXJE",liftStats:"dashboard_liftStats__NTfp7",liftDate:"dashboard_liftDate__swp5k"}},3321:function(e){e.exports={formContainer:"LogLiftForm_formContainer__55lXu",formGrid:"LogLiftForm_formGrid__MpDyX",formGroup:"LogLiftForm_formGroup__FwFsu",label:"LogLiftForm_label__LYWnL",input:"LogLiftForm_input__6AC_q",select:"LogLiftForm_select__n7a_R",textArea:"LogLiftForm_textArea__HgSSb",submitBtn:"LogLiftForm_submitBtn__UiE7U"}}},function(e){e.O(0,[101,288,301,971,69,744],function(){return e(e.s=8127)}),_N_E=e.O()}]);