(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[173],{3880:function(e,t,r){Promise.resolve().then(r.bind(r,774))},7461:function(e,t,r){"use strict";r.d(t,{Z:function(){return s}});var l=r(4090),n={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.316.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let i=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),s=(e,t)=>{let r=(0,l.forwardRef)((r,s)=>{let{color:a="currentColor",size:o=24,strokeWidth:d=2,absoluteStrokeWidth:c,className:u="",children:h,...x}=r;return(0,l.createElement)("svg",{ref:s,...n,width:o,height:o,stroke:a,strokeWidth:c?24*Number(d)/Number(o):d,className:["lucide","lucide-".concat(i(e)),u].join(" "),...x},[...t.map(e=>{let[t,r]=e;return(0,l.createElement)(t,r)}),...Array.isArray(h)?h:[h]])});return r.displayName="".concat(e),r}},774:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return p}});var l=r(3827),n=r(4090),i=r(1097),s=r(7020),a=r.n(s),o=r(7461);/**
 * @license lucide-react v0.316.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let d=(0,o.Z)("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]),c=(0,o.Z)("Send",[["path",{d:"m22 2-7 20-4-9-9-4Z",key:"1q3vgg"}],["path",{d:"M22 2 11 13",key:"nzbqef"}]]),u=(0,o.Z)("Heart",[["path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z",key:"c3ymky"}]]),h=(0,o.Z)("MessageCircle",[["path",{d:"M7.9 20A9 9 0 1 0 4 16.1L2 22Z",key:"vv11sd"}]]);var x=r(6288);let m=e=>{let{logId:t,userId:r}=e,[s,a]=(0,n.useState)([]),[o,u]=(0,n.useState)(!0),[h,m]=(0,n.useState)(""),[p,f]=(0,n.useState)(!1),v=(0,i.e)(),y=async()=>{u(!0);let{data:e}=await v.from("comments").select("\n                *,\n                profiles (\n                    username,\n                    full_name,\n                    avatar_url\n                )\n            ").eq("log_id",t).order("created_at",{ascending:!0});e&&a(e),u(!1)};(0,n.useEffect)(()=>{y()},[t]);let g=async e=>{if(e.preventDefault(),!r||!h.trim())return;f(!0);let{error:l}=await v.from("comments").insert({log_id:t,user_id:r,content:h.trim()});l?x.toast.error("Failed to post comment"):(m(""),y()),f(!1)},j=async e=>{if(!confirm("Are you sure you want to delete this comment?"))return;let{error:t}=await v.from("comments").delete().eq("id",e);t?x.toast.error("Failed to delete comment"):(a(s.filter(t=>t.id!==e)),x.toast.success("Comment deleted"))};return(0,l.jsxs)("div",{style:{padding:"15px",background:"var(--bg-secondary)",borderTop:"1px solid var(--border-color)"},children:[o?(0,l.jsx)("div",{style:{fontSize:"0.9rem",color:"var(--text-secondary)"},children:"Loading comments..."}):0===s.length?(0,l.jsx)("div",{style:{fontSize:"0.9rem",color:"var(--text-secondary)",marginBottom:"10px"},children:"No comments yet. Be the first!"}):(0,l.jsx)("div",{style:{display:"flex",flexDirection:"column",gap:"10px",marginBottom:"15px"},children:s.map(e=>{var t,n,i;return(0,l.jsxs)("div",{style:{display:"flex",gap:"10px"},children:[(0,l.jsx)("div",{style:{width:"30px",height:"30px",borderRadius:"50%",overflow:"hidden",background:"#333",flexShrink:0},children:(null===(t=e.profiles)||void 0===t?void 0:t.avatar_url)&&(0,l.jsx)("img",{src:e.profiles.avatar_url,style:{width:"100%",height:"100%",objectFit:"cover"}})}),(0,l.jsxs)("div",{style:{flex:1},children:[(0,l.jsxs)("div",{style:{fontSize:"0.85rem",fontWeight:"600",display:"flex",alignItems:"center",justifyContent:"space-between"},children:[(0,l.jsxs)("span",{children:[(null===(n=e.profiles)||void 0===n?void 0:n.full_name)||(null===(i=e.profiles)||void 0===i?void 0:i.username)||"User",(0,l.jsx)("span",{style:{fontSize:"0.75rem",color:"var(--text-secondary)",fontWeight:"normal",marginLeft:"8px"},children:new Date(e.created_at).toLocaleDateString()})]}),r===e.user_id&&(0,l.jsx)("button",{onClick:()=>j(e.id),style:{background:"none",border:"none",cursor:"pointer",color:"var(--text-muted)",padding:"4px"},title:"Delete comment",children:(0,l.jsx)(d,{size:14})})]}),(0,l.jsx)("div",{style:{fontSize:"0.9rem",color:"var(--text-primary)"},children:e.content})]})]},e.id)})}),r?(0,l.jsxs)("form",{onSubmit:g,style:{display:"flex",gap:"10px"},children:[(0,l.jsx)("input",{type:"text",value:h,onChange:e=>m(e.target.value),placeholder:"Write a comment...",style:{flex:1,padding:"8px",borderRadius:"4px",border:"1px solid var(--border-color)",background:"var(--bg-card)",color:"var(--text-primary)"}}),(0,l.jsx)("button",{type:"submit",disabled:p,className:"btn btn-sm",style:{display:"flex",alignItems:"center"},children:(0,l.jsx)(c,{size:16})})]}):(0,l.jsx)("div",{style:{fontSize:"0.9rem",color:"var(--text-secondary)"},children:"Log in to comment"})]})};function p(){let[e,t]=(0,n.useState)([]),[r,s]=(0,n.useState)("latest"),[o,d]=(0,n.useState)([]),[c,p]=(0,n.useState)(!1),[f,v]=(0,n.useState)(null),[y,g]=(0,n.useState)(null),j=(0,i.e)();(0,n.useEffect)(()=>{let e=async()=>{let{data:{user:e}}=await j.auth.getUser();v((null==e?void 0:e.id)||null)};(async()=>{let{data:e}=await j.from("lift_types").select("*").order("name");e&&e.length>0&&t(e)})(),e()},[]);let _=async()=>{p(!0);let e=j.from("logs").select("\n          *,\n          profiles (\n            username,\n            full_name,\n            avatar_url\n          ),\n          lift_types (\n            name\n          ),\n          likes!left (\n            user_id\n          ),\n          comments!left (\n            count\n          )\n        ");e="latest"===r?e.order("date_logged",{ascending:!1}):e.eq("lift_type_id",parseInt(r)).order("weight",{ascending:!1});let{data:t,error:l}=await e.limit(50);t&&d(t),p(!1)};(0,n.useEffect)(()=>{_()},[r]);let b=async(e,t)=>{if(!f){x.toast.error("Please log in to like lifts");return}let r=t.some(e=>e.user_id===f);d(o.map(t=>t.id===e?{...t,likes:r?t.likes.filter(e=>e.user_id!==f):[...t.likes,{user_id:f}]}:t)),r?await j.from("likes").delete().match({user_id:f,log_id:e}):await j.from("likes").insert({user_id:f,log_id:e})};return(0,l.jsxs)("div",{children:[(0,l.jsxs)("div",{className:a().pageHeader,children:[(0,l.jsx)("h1",{children:"Leaderboard"}),(0,l.jsxs)("select",{className:a().filterSelect,value:r,onChange:e=>s(e.target.value),children:[(0,l.jsx)("option",{value:"latest",children:"Latest Lifts"}),e.map(e=>(0,l.jsx)("option",{value:e.id,children:e.name},e.id))]})]}),(0,l.jsx)("div",{className:a().tableContainer,children:(0,l.jsxs)("table",{className:a().table,style:{borderCollapse:"collapse"},children:[(0,l.jsx)("thead",{children:(0,l.jsxs)("tr",{children:[(0,l.jsx)("th",{children:"Rank"}),(0,l.jsx)("th",{children:"Lifter"}),(0,l.jsx)("th",{children:"Lift"}),(0,l.jsx)("th",{children:"Weight"}),(0,l.jsx)("th",{children:"Date"}),(0,l.jsx)("th",{children:"Notes"}),(0,l.jsx)("th",{children:"Actions"})]})}),(0,l.jsx)("tbody",{children:c?(0,l.jsx)("tr",{children:(0,l.jsx)("td",{colSpan:7,style:{textAlign:"center"},children:"Loading..."})}):0===o.length?(0,l.jsx)("tr",{children:(0,l.jsx)("td",{colSpan:7,style:{textAlign:"center"},children:"No lifts..."})}):o.map((e,t)=>{var r,n,i,s,o,d,c,x;let p=null===(r=e.likes)||void 0===r?void 0:r.some(e=>e.user_id===f),v=y===e.id,j=(null===(i=e.comments)||void 0===i?void 0:null===(n=i[0])||void 0===n?void 0:n.count)||0;return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)("tr",{style:{borderBottom:v?"none":"1px solid var(--border-color)"},children:[(0,l.jsxs)("td",{className:a().rank,children:["#",t+1]}),(0,l.jsx)("td",{children:(0,l.jsxs)("div",{className:a().userCell,children:[(null===(s=e.profiles)||void 0===s?void 0:s.avatar_url)&&(0,l.jsx)("img",{src:e.profiles.avatar_url,alt:"avatar",className:a().avatar}),(0,l.jsx)("span",{children:(null===(o=e.profiles)||void 0===o?void 0:o.full_name)||(null===(d=e.profiles)||void 0===d?void 0:d.username)||"Anonymous"})]})}),(0,l.jsx)("td",{children:(null===(c=e.lift_types)||void 0===c?void 0:c.name)||e.lift_name||"-"}),(0,l.jsxs)("td",{className:a().weight,children:[e.weight," ",e.unit]}),(0,l.jsx)("td",{className:a().date,children:new Date(e.date_logged).toLocaleDateString()}),(0,l.jsx)("td",{style:{maxWidth:"200px",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",color:"var(--text-secondary)"},children:e.notes||"-"}),(0,l.jsx)("td",{children:(0,l.jsxs)("div",{style:{display:"flex",gap:"15px"},children:[(0,l.jsxs)("button",{onClick:()=>b(e.id,e.likes||[]),style:{background:"none",border:"none",cursor:"pointer",display:"flex",alignItems:"center",gap:"4px",color:"inherit"},children:[(0,l.jsx)(u,{size:18,fill:p?"#ef4444":"none",color:p?"#ef4444":"currentColor"}),(0,l.jsx)("span",{children:(null===(x=e.likes)||void 0===x?void 0:x.length)||0})]}),(0,l.jsxs)("button",{onClick:()=>g(v?null:e.id),style:{background:"none",border:"none",cursor:"pointer",display:"flex",alignItems:"center",gap:"4px",color:v?"var(--brand-primary)":"inherit"},children:[(0,l.jsx)(h,{size:18}),(0,l.jsx)("span",{children:j})]})]})})]},e.id),v&&(0,l.jsx)("tr",{children:(0,l.jsx)("td",{colSpan:7,style:{padding:0},children:(0,l.jsx)(m,{logId:e.id,userId:f})})})]})})})]})})]})}},1097:function(e,t,r){"use strict";r.d(t,{e:function(){return n}});var l=r(101);function n(){return(0,l.AY)("https://svqlrwwchfhyinqinbuo.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InN2cWxyd3djaGZoeWlucWluYnVvIiwicm9sZSI6InNlcnZpY2Vfcm9sZSIsImlhdCI6MTc2OTkxMDA2OCwiZXhwIjoyMDg1NDg2MDY4fQ.VpbGvrgtuzIuE6s_QYwsTrHWSijtSzrO7vTJcSOayx0")}},7020:function(e){e.exports={pageHeader:"leaderboard_pageHeader__bJ6EC",filterSelect:"leaderboard_filterSelect__EBI0S",tableContainer:"leaderboard_tableContainer__qsX55",table:"leaderboard_table__L202w",rank:"leaderboard_rank__zS6Dw",userCell:"leaderboard_userCell__YU5Mm",avatar:"leaderboard_avatar__FUbYo",weight:"leaderboard_weight__9U_8t",date:"leaderboard_date__GfsJP"}}},function(e){e.O(0,[101,288,971,69,744],function(){return e(e.s=3880)}),_N_E=e.O()}]);