module.exports=[16238,a=>{a.v({avatar:"leaderboard-module__hOVDzq__avatar",date:"leaderboard-module__hOVDzq__date",filterSelect:"leaderboard-module__hOVDzq__filterSelect",pageHeader:"leaderboard-module__hOVDzq__pageHeader",rank:"leaderboard-module__hOVDzq__rank",table:"leaderboard-module__hOVDzq__table",tableContainer:"leaderboard-module__hOVDzq__tableContainer",userCell:"leaderboard-module__hOVDzq__userCell",weight:"leaderboard-module__hOVDzq__weight"})},19837,a=>{"use strict";var b=a.i(16815),c=a.i(72074),d=a.i(66181),e=a.i(16238),f=a.i(88428);let g=(0,f.default)("Heart",[["path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z",key:"c3ymky"}]]),h=(0,f.default)("MessageCircle",[["path",{d:"M7.9 20A9 9 0 1 0 4 16.1L2 22Z",key:"vv11sd"}]]),i=(0,f.default)("Send",[["path",{d:"m22 2-7 20-4-9-9-4Z",key:"1q3vgg"}],["path",{d:"M22 2 11 13",key:"nzbqef"}]]),j=(0,f.default)("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);var k=a.i(77856);let l=({logId:a,userId:e})=>{let[f,g]=(0,c.useState)([]),[h,l]=(0,c.useState)(!0),[m,n]=(0,c.useState)(""),[o,p]=(0,c.useState)(!1),q=(0,d.createClient)(),r=async()=>{l(!0);let{data:b}=await q.from("comments").select(`
                *,
                profiles (
                    username,
                    full_name,
                    avatar_url
                )
            `).eq("log_id",a).order("created_at",{ascending:!0});b&&g(b),l(!1)};(0,c.useEffect)(()=>{r()},[a]);let s=async b=>{if(b.preventDefault(),!e||!m.trim())return;p(!0);let{error:c}=await q.from("comments").insert({log_id:a,user_id:e,content:m.trim()});c?k.toast.error("Failed to post comment"):(n(""),r()),p(!1)},t=async a=>{if(!confirm("Are you sure you want to delete this comment?"))return;let{error:b}=await q.from("comments").delete().eq("id",a);b?k.toast.error("Failed to delete comment"):(g(f.filter(b=>b.id!==a)),k.toast.success("Comment deleted"))};return(0,b.jsxs)("div",{style:{padding:"15px",background:"var(--bg-secondary)",borderTop:"1px solid var(--border-color)"},children:[h?(0,b.jsx)("div",{style:{fontSize:"0.9rem",color:"var(--text-secondary)"},children:"Loading comments..."}):0===f.length?(0,b.jsx)("div",{style:{fontSize:"0.9rem",color:"var(--text-secondary)",marginBottom:"10px"},children:"No comments yet. Be the first!"}):(0,b.jsx)("div",{style:{display:"flex",flexDirection:"column",gap:"10px",marginBottom:"15px"},children:f.map(a=>(0,b.jsxs)("div",{style:{display:"flex",gap:"10px"},children:[(0,b.jsx)("div",{style:{width:"30px",height:"30px",borderRadius:"50%",overflow:"hidden",background:"#333",flexShrink:0},children:a.profiles?.avatar_url&&(0,b.jsx)("img",{src:a.profiles.avatar_url,style:{width:"100%",height:"100%",objectFit:"cover"}})}),(0,b.jsxs)("div",{style:{flex:1},children:[(0,b.jsxs)("div",{style:{fontSize:"0.85rem",fontWeight:"600",display:"flex",alignItems:"center",justifyContent:"space-between"},children:[(0,b.jsxs)("span",{children:[a.profiles?.full_name||a.profiles?.username||"User",(0,b.jsx)("span",{style:{fontSize:"0.75rem",color:"var(--text-secondary)",fontWeight:"normal",marginLeft:"8px"},children:new Date(a.created_at).toLocaleDateString()})]}),e===a.user_id&&(0,b.jsx)("button",{onClick:()=>t(a.id),style:{background:"none",border:"none",cursor:"pointer",color:"var(--text-muted)",padding:"4px"},title:"Delete comment",children:(0,b.jsx)(j,{size:14})})]}),(0,b.jsx)("div",{style:{fontSize:"0.9rem",color:"var(--text-primary)"},children:a.content})]})]},a.id))}),e?(0,b.jsxs)("form",{onSubmit:s,style:{display:"flex",gap:"10px"},children:[(0,b.jsx)("input",{type:"text",value:m,onChange:a=>n(a.target.value),placeholder:"Write a comment...",style:{flex:1,padding:"8px",borderRadius:"4px",border:"1px solid var(--border-color)",background:"var(--bg-card)",color:"var(--text-primary)"}}),(0,b.jsx)("button",{type:"submit",disabled:o,className:"btn btn-sm",style:{display:"flex",alignItems:"center"},children:(0,b.jsx)(i,{size:16})})]}):(0,b.jsx)("div",{style:{fontSize:"0.9rem",color:"var(--text-secondary)"},children:"Log in to comment"})]})};function m(){let[a,f]=(0,c.useState)([]),[i,j]=(0,c.useState)("latest"),[m,n]=(0,c.useState)([]),[o,p]=(0,c.useState)(!1),[q,r]=(0,c.useState)(null),[s,t]=(0,c.useState)(null),u=(0,d.createClient)();(0,c.useEffect)(()=>{let a=async()=>{let{data:{user:a}}=await u.auth.getUser();r(a?.id||null)};(async()=>{let{data:a}=await u.from("lift_types").select("*").order("name");a&&a.length>0&&f(a)})(),a()},[]);let v=async()=>{p(!0);let a=u.from("logs").select(`
          *,
          profiles (
            username,
            full_name,
            avatar_url
          ),
          lift_types (
            name
          ),
          likes!left (
            user_id
          ),
          comments!left (
            count
          )
        `);a="latest"===i?a.order("date_logged",{ascending:!1}):a.eq("lift_type_id",parseInt(i)).order("weight",{ascending:!1});let{data:b,error:c}=await a.limit(50);b&&n(b),p(!1)};(0,c.useEffect)(()=>{v()},[i]);let w=async(a,b)=>{if(!q)return void k.toast.error("Please log in to like lifts");let c=b.some(a=>a.user_id===q);n(m.map(b=>b.id===a?{...b,likes:c?b.likes.filter(a=>a.user_id!==q):[...b.likes,{user_id:q}]}:b)),c?await u.from("likes").delete().match({user_id:q,log_id:a}):await u.from("likes").insert({user_id:q,log_id:a})};return(0,b.jsxs)("div",{children:[(0,b.jsxs)("div",{className:e.default.pageHeader,children:[(0,b.jsx)("h1",{children:"Leaderboard"}),(0,b.jsxs)("select",{className:e.default.filterSelect,value:i,onChange:a=>j(a.target.value),children:[(0,b.jsx)("option",{value:"latest",children:"Latest Lifts"}),a.map(a=>(0,b.jsx)("option",{value:a.id,children:a.name},a.id))]})]}),(0,b.jsx)("div",{className:e.default.tableContainer,children:(0,b.jsxs)("table",{className:e.default.table,style:{borderCollapse:"collapse"},children:[(0,b.jsx)("thead",{children:(0,b.jsxs)("tr",{children:[(0,b.jsx)("th",{children:"Rank"}),(0,b.jsx)("th",{children:"Lifter"}),(0,b.jsx)("th",{children:"Lift"}),(0,b.jsx)("th",{children:"Weight"}),(0,b.jsx)("th",{children:"Date"}),(0,b.jsx)("th",{children:"Notes"}),(0,b.jsx)("th",{children:"Actions"})]})}),(0,b.jsx)("tbody",{children:o?(0,b.jsx)("tr",{children:(0,b.jsx)("td",{colSpan:7,style:{textAlign:"center"},children:"Loading..."})}):0===m.length?(0,b.jsx)("tr",{children:(0,b.jsx)("td",{colSpan:7,style:{textAlign:"center"},children:"No lifts..."})}):m.map((a,c)=>{let d=a.likes?.some(a=>a.user_id===q),f=s===a.id,i=a.comments?.[0]?.count||0;return(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)("tr",{style:{borderBottom:f?"none":"1px solid var(--border-color)"},children:[(0,b.jsxs)("td",{className:e.default.rank,children:["#",c+1]}),(0,b.jsx)("td",{children:(0,b.jsxs)("div",{className:e.default.userCell,children:[a.profiles?.avatar_url&&(0,b.jsx)("img",{src:a.profiles.avatar_url,alt:"avatar",className:e.default.avatar}),(0,b.jsx)("span",{children:a.profiles?.full_name||a.profiles?.username||"Anonymous"})]})}),(0,b.jsx)("td",{children:a.lift_types?.name||a.lift_name||"-"}),(0,b.jsxs)("td",{className:e.default.weight,children:[a.weight," ",a.unit]}),(0,b.jsx)("td",{className:e.default.date,children:new Date(a.date_logged).toLocaleDateString()}),(0,b.jsx)("td",{style:{maxWidth:"200px",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",color:"var(--text-secondary)"},children:a.notes||"-"}),(0,b.jsx)("td",{children:(0,b.jsxs)("div",{style:{display:"flex",gap:"15px"},children:[(0,b.jsxs)("button",{onClick:()=>w(a.id,a.likes||[]),style:{background:"none",border:"none",cursor:"pointer",display:"flex",alignItems:"center",gap:"4px",color:"inherit"},children:[(0,b.jsx)(g,{size:18,fill:d?"#ef4444":"none",color:d?"#ef4444":"currentColor"}),(0,b.jsx)("span",{children:a.likes?.length||0})]}),(0,b.jsxs)("button",{onClick:()=>t(f?null:a.id),style:{background:"none",border:"none",cursor:"pointer",display:"flex",alignItems:"center",gap:"4px",color:f?"var(--brand-primary)":"inherit"},children:[(0,b.jsx)(h,{size:18}),(0,b.jsx)("span",{children:i})]})]})})]},a.id),f&&(0,b.jsx)("tr",{children:(0,b.jsx)("td",{colSpan:7,style:{padding:0},children:(0,b.jsx)(l,{logId:a.id,userId:q})})})]})})})]})})]})}a.s(["default",()=>m],19837)}];

//# sourceMappingURL=Documents_liftlog_src_app_leaderboard_0787cd9a._.js.map