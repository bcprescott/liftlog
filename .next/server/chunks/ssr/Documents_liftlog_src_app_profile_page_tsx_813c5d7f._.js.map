{"version":3,"sources":["../../../../../../Documents/liftlog/src/app/profile/page.tsx"],"sourcesContent":["'use client'\r\nimport { useEffect, useState } from 'react'\r\nimport { createClient } from '@/lib/supabase/client'\r\nimport { useRouter } from 'next/navigation'\r\nimport { toast } from 'sonner'\r\nimport { Database } from '@/types/supabase'\r\n\r\ntype Profile = Database['public']['Tables']['profiles']['Row']\r\n\r\nexport default function ProfilePage() {\r\n    const supabase = createClient()\r\n    const router = useRouter()\r\n\r\n    const [loading, setLoading] = useState(true)\r\n    const [updating, setUpdating] = useState(false)\r\n    const [fullName, setFullName] = useState('')\r\n    const [avatarUrl, setAvatarUrl] = useState('')\r\n    const [userId, setUserId] = useState<string | null>(null)\r\n\r\n    useEffect(() => {\r\n        const getProfile = async () => {\r\n            const { data: { user } } = await supabase.auth.getUser()\r\n\r\n            if (!user) {\r\n                router.push('/login')\r\n                return\r\n            }\r\n\r\n            setUserId(user.id)\r\n\r\n            const { data, error } = await supabase\r\n                .from('profiles')\r\n                .select('*')\r\n                .eq('id', user.id)\r\n                .single()\r\n\r\n            if (error) {\r\n                console.error('Error loading profile:', error)\r\n                toast.error('Failed to load profile')\r\n            } else if (data) {\r\n                const profile = data as Profile\r\n                setFullName(profile.full_name || '')\r\n                setAvatarUrl(profile.avatar_url || '')\r\n            }\r\n\r\n            setLoading(false)\r\n        }\r\n\r\n        getProfile()\r\n    }, [router, supabase])\r\n\r\n    const updateProfile = async () => {\r\n        if (!userId) return\r\n\r\n        setUpdating(true)\r\n        const updates = {\r\n            id: userId,\r\n            full_name: fullName,\r\n            avatar_url: avatarUrl,\r\n            updated_at: new Date().toISOString(),\r\n        }\r\n\r\n        const { error } = await supabase.from('profiles').upsert(updates as any)\r\n\r\n        if (error) {\r\n            toast.error('Failed to update profile')\r\n            console.error(error)\r\n        } else {\r\n            toast.success('Profile updated!')\r\n            router.refresh()\r\n        }\r\n        setUpdating(false)\r\n    }\r\n\r\n    if (loading) {\r\n        return <div style={{ padding: '20px', textAlign: 'center' }}>Loading profile...</div>\r\n    }\r\n\r\n    return (\r\n        <div style={{ maxWidth: '600px', margin: '40px auto', padding: '0 20px' }}>\r\n            <h1 style={{ fontSize: '2rem', marginBottom: '2rem' }}>Profile</h1>\r\n\r\n            <div style={{ background: 'var(--bg-card)', padding: '30px', borderRadius: 'var(--radius)', border: '1px solid var(--border-color)' }}>\r\n                {/* Avatar Preview */}\r\n                <div style={{ display: 'flex', justifyContent: 'center', marginBottom: '2rem' }}>\r\n                    <div style={{ width: '100px', height: '100px', borderRadius: '50%', overflow: 'hidden', background: 'var(--bg-secondary)', border: '2px solid var(--border-color)' }}>\r\n                        {avatarUrl ? (\r\n                            <img src={avatarUrl} alt=\"Avatar\" style={{ width: '100%', height: '100%', objectFit: 'cover' }} />\r\n                        ) : (\r\n                            <div style={{ width: '100%', height: '100%', display: 'flex', alignItems: 'center', justifyContent: 'center', color: 'var(--text-muted)' }}>\r\n                                No Img\r\n                            </div>\r\n                        )}\r\n                    </div>\r\n                </div>\r\n\r\n                <div style={{ marginBottom: '1.5rem' }}>\r\n                    <label style={{ display: 'block', marginBottom: '0.5rem', fontWeight: '500' }}>Full Name</label>\r\n                    <input\r\n                        type=\"text\"\r\n                        value={fullName}\r\n                        onChange={(e) => setFullName(e.target.value)}\r\n                        placeholder=\"John Doe\"\r\n                        style={{ width: '100%', padding: '10px', borderRadius: 'var(--radius)', border: '1px solid var(--border-color)', background: 'var(--input-bg)', color: 'var(--text-primary)' }}\r\n                    />\r\n                </div>\r\n\r\n                <div style={{ marginBottom: '2rem' }}>\r\n                    <label style={{ display: 'block', marginBottom: '0.5rem', fontWeight: '500' }}>Avatar Image</label>\r\n                    <div style={{ display: 'flex', gap: '10px', alignItems: 'center' }}>\r\n                        <input\r\n                            type=\"file\"\r\n                            accept=\"image/*\"\r\n                            onChange={async (e) => {\r\n                                if (!e.target.files || e.target.files.length === 0) return\r\n                                const file = e.target.files[0]\r\n                                const fileExt = file.name.split('.').pop()\r\n                                const filePath = `${userId}-${Math.random()}.${fileExt}`\r\n                                setUpdating(true)\r\n\r\n                                const { error: uploadError } = await supabase.storage\r\n                                    .from('avatars')\r\n                                    .upload(filePath, file)\r\n\r\n                                if (uploadError) {\r\n                                    toast.error('Error uploading image')\r\n                                    console.error(uploadError)\r\n                                    setUpdating(false)\r\n                                    return\r\n                                }\r\n\r\n                                const { data: { publicUrl } } = supabase.storage\r\n                                    .from('avatars')\r\n                                    .getPublicUrl(filePath)\r\n\r\n                                setAvatarUrl(publicUrl)\r\n                                setUpdating(false)\r\n                            }}\r\n                            style={{ color: 'var(--text-primary)' }}\r\n                        />\r\n                    </div>\r\n                    <p style={{ fontSize: '0.8rem', color: 'var(--text-secondary)', marginTop: '0.5rem' }}>\r\n                        Or paste a URL below:\r\n                    </p>\r\n                    <input\r\n                        type=\"text\"\r\n                        value={avatarUrl}\r\n                        onChange={(e) => setAvatarUrl(e.target.value)}\r\n                        placeholder=\"https://example.com/avatar.jpg\"\r\n                        style={{ width: '100%', padding: '10px', borderRadius: 'var(--radius)', border: '1px solid var(--border-color)', background: 'var(--input-bg)', color: 'var(--text-primary)' }}\r\n                    />\r\n                </div>\r\n\r\n                <button\r\n                    onClick={updateProfile}\r\n                    className=\"btn btn-primary\"\r\n                    disabled={updating}\r\n                    style={{ width: '100%', padding: '12px' }}\r\n                >\r\n                    {updating ? 'Saving...' : 'Update Profile'}\r\n                </button>\r\n            </div>\r\n        </div>\r\n    )\r\n}\r\n"],"names":[],"mappings":"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"}